{
  "c54e70bc-12f9-43ee-9fec-4eae933668c3": {
    "policy_id": "c54e70bc-12f9-43ee-9fec-4eae933668c3",
    "policy_name": "Page 61 1.2.3 (L1) Ensure 'Allow Administrator account lockout' is set to",
    "registry_path": "N/A:\\N/A",
    "registry_hive": "N/A",
    "registry_key": "N/A",
    "registry_value_name": "N/A",
    "registry_value_type": "N/A",
    "enabled_value": "1",
    "disabled_value": "0",
    "gpo_path": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Local Policies\\Security Options",
    "gpo_setting": "Accounts: Allow Administrator account lockout",
    "secedit_section": "[Security Options]",
    "secedit_setting": "AllowAdministratorLockout",
    "powershell_command": "$tempInfPath = Join-Path -Path $env:TEMP -ChildPath \"AdminLockout_Enabled.inf\"\n    $infContent = @'\n[Unicode]\nUnicode=yes\n[Version]\nsignature=\"$CHICAGO$\"\nRevision=1\n[Security Options]\nAllowAdministratorLockout = 1\n'@\n\n    # Create the .inf file with the policy setting\n    Set-Content -Path $tempInfPath -Value $infContent -Encoding Unicode\n\n    # Apply the security policy using secedit\n    secedit /configure /db \"$env:SystemRoot\\Security\\database\\scesrv.sdb\" /cfg \"$tempInfPath\" /overwrite /areas SECURITYPOLICY\n\n    # Clean up the temporary .inf file\n    Remove-Item -Path $tempInfPath -Force -ErrorAction SilentlyContinue\n\n    Write-Host \"Policy 'Allow Administrator account lockout' set to Enabled via secedit. A 'gpupdate /force' and possibly a reboot/logoff might be required for full effect.\"",
    "verification_command": "$regPath = \"HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa\"\n$valueName = \"AdminAccountLockout\"\n\n# Attempt to retrieve the registry value where this policy's effective state is stored\n$currentValue = Get-ItemPropertyValue -Path $regPath -Name $valueName -ErrorAction SilentlyContinue\n\nif ($currentValue -eq $null) {\n    Write-Host \"Policy setting 'Allow Administrator account lockout' (AdminAccountLockout) is not found or not yet applied. This might indicate the OS is not patched (KB5020282) or the policy has not been configured/propagated.\" -ForegroundColor Yellow\n} elseif ($currentValue -eq 1) {\n    Write-Host \"Policy 'Allow Administrator account lockout' is correctly set to Enabled (Current value: $currentValue).\" -ForegroundColor Green\n} else {\n    Write-Host \"Policy 'Allow Administrator account lockout' is set to Disabled (Current value: $currentValue). Remediation is required.\" -ForegroundColor Red\n}",
    "remediation_notes": "This setting applies only to OSes patched as of October 11, 2022 (see MS KB5020282). Ensure the system is updated to a version that supports this functionality before applying the policy. If the built-in Administrator account is frequently used for interactive logons, ensure robust monitoring and management practices are in place (e.g., account lockout thresholds, short lockout durations, automated alerts) to prevent accidental lockout, which could lead to denial of service. Consider renaming the Administrator account to further obscure it from attackers. After applying the policy, run 'gpupdate /force' to ensure propagation.",
    "requires_reboot": false,
    "risk_level": "Medium"
  },
  "bdaa0fa3-6466-4722-a103-a9c987d2cc9d": {
    "policy_id": "bdaa0fa3-6466-4722-a103-a9c987d2cc9d",
    "policy_name": "Page 63 1.2.4 (L1) Ensure 'Reset account lockout counter after' is set to",
    "registry_path": "N/A:\\N/A",
    "registry_hive": "N/A",
    "registry_key": "N/A",
    "registry_value_name": "N/A",
    "registry_value_type": "N/A",
    "enabled_value": "15",
    "disabled_value": "0",
    "gpo_path": "Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Account Policies\\Account Lockout Policy",
    "gpo_setting": "Reset account lockout counter after",
    "secedit_section": "[System Access]",
    "secedit_setting": "ResetLockoutCount",
    "powershell_command": "net accounts /lockoutreset:15",
    "verification_command": "(net accounts | Select-String -Pattern 'Lockout reset in:').ToString().Split(':')[1].Trim()",
    "remediation_notes": "This policy controls how long it takes for the account lockout counter to reset to zero after a specified number of failed logon attempts. For domain user accounts, this policy must be applied via the Default Domain Policy GPO. If configured in another GPO, it will only affect local user accounts on the computers that receive the GPO. Custom exceptions for specific domain users/groups can be achieved using Password Settings Objects (PSOs) in Active Directory Administrative Center. The recommended setting is 15 minutes or more. Setting it to 0 or 'Not Defined' means the counter never resets automatically, requiring manual unlocking of accounts and making the system vulnerable to Denial-of-Service (DoS) attacks where all accounts could be locked out indefinitely by an attacker.",
    "requires_reboot": false,
    "risk_level": "Medium"
  },
  "82e32be3-cc8f-4d45-b353-0197177dd2f2": {
    "policy_id": "82e32be3-cc8f-4d45-b353-0197177dd2f2",
    "policy_name": "Page 39 1.1.1 (L1) Ensure 'Enforce password history' is set to '24 or more",
    "registry_path": "N/A:\\N/A",
    "registry_hive": "N/A",
    "registry_key": "N/A",
    "registry_value_name": "N/A",
    "registry_value_type": "N/A",
    "enabled_value": "24",
    "disabled_value": "0",
    "gpo_path": "Computer Configuration\\Windows Settings\\Security Settings\\Account Policies\\Password Policy",
    "gpo_setting": "Enforce password history",
    "secedit_section": "[System Access]",
    "secedit_setting": "PasswordHistorySize",
    "powershell_command": "net accounts /uniquepw:24",
    "verification_command": "(net accounts | Select-String -Pattern 'Minimum password history').ToString().Split(':')[1].Trim()",
    "remediation_notes": "For domain-joined systems, this policy should be configured in the Default Domain Policy GPO. For standalone systems or local user accounts, `net accounts` or the Local Security Policy editor (which writes to the secedit database) is used. The maximum value supported by Microsoft is 24. Setting this value to '0' disables password history.",
    "requires_reboot": false,
    "risk_level": "High"
  },
  "2d46374f-ac6a-4e29-97b5-f696d6ca9a4a": {
    "policy_id": "2d46374f-ac6a-4e29-97b5-f696d6ca9a4a",
    "policy_name": "Page 3 1.1.3 (L1) Ensure 'Minimum password age' is set to '1 or more day(s)' (Automated)  ..............  44",
    "registry_path": "N/A:\\N/A",
    "registry_hive": "N/A",
    "registry_key": "N/A",
    "registry_value_name": "N/A",
    "registry_value_type": "N/A",
    "enabled_value": "1",
    "disabled_value": "0",
    "gpo_path": "Computer Configuration\\Windows Settings\\Security Settings\\Account Policies\\Password Policy",
    "gpo_setting": "Minimum password age",
    "secedit_section": "[System Access]",
    "secedit_setting": "MinimumPasswordAge",
    "powershell_command": "net accounts /minpwage:1",
    "verification_command": "$minPwAge = (net accounts | Select-String \"Minimum password age\").ToString() | ForEach-Object { if ($_ -match 'Minimum password age:\\s+(\\d+)') { $Matches[1] } else { '' } }; if ($minPwAge -and ([int]$minPwAge -ge 1)) { Write-Host \"Minimum password age is set to $minPwAge day(s), which is compliant.\" } else { Write-Host \"Minimum password age is set to $minPwAge day(s) or not found, which is NOT compliant.\" }",
    "remediation_notes": "This policy setting prevents users from changing their password multiple times in a short period to circumvent the password history policy. Setting it to '1 or more day(s)' ensures that a password cannot be changed immediately after being set. A value of '0' allows immediate password changes, which is generally not recommended for security.",
    "requires_reboot": false,
    "risk_level": "Medium"
  }
}